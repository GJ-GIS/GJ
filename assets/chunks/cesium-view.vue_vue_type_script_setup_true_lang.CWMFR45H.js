import*as o from"/GJ/cesiumStatic/index.js";import{D as y,p as g,v as I,$ as x,d as M,q as b,o as V,c as k,j as d,k as f,r as C,e as B}from"./framework.BSn6qPJ2.js";import{u as A}from"./theme.D5TsysKk.js";class a{constructor(){this.viewerMap=new Map,this.defaultViewerId="default"}static getInstance(){return a.instance||(a.instance=new a),a.instance}register(e,r){if(!e)throw new Error("必须提供有效的 Viewer 实例。");const s=r||this.defaultViewerId;if(this.viewerMap.has(s))throw new Error(`ID "${String(s)}" 已经被注册。`);return this.viewerMap.set(s,e),e}get(e=this.defaultViewerId){if(!this.viewerMap.has(e))throw new Error(`ID "${e}" 对应的 Viewer 未注册。`);return this.viewerMap.get(e)}getIdByViewer(e){for(let[r,s]of this.viewerMap)if(s===e)return r}safeGet(e=this.defaultViewerId){return this.viewerMap.get(e)}unregister(e=this.defaultViewerId){return this.viewerMap.has(e)?(this.viewerMap.get(e).destroy(),this.viewerMap.delete(e),!0):(console.warn(`ID "${e}" 对应的 Viewer 不存在，无法注销。`),!1)}getAllViewerIds(){return Array.from(this.viewerMap.keys())}getAllViewers(){return Array.from(this.viewerMap.values())}isRegistered(e=this.defaultViewerId){return this.viewerMap.has(e)}size(){return this.viewerMap.size}replace(e,r){if(!this.viewerMap.has(e))throw new Error(`Viewer with ID "${e}" does not exist.`);this.viewerMap.set(e,r)}}const w=a.getInstance(),p=y();function E(h,e){const r=g(!1);I(()=>{r.value=!0,typeof window<"u"&&typeof document<"u"&&u(e)}),x(()=>{r.value=!1,w.unregister()});function s(){w.unregister(),p.value=void 0}function u(i){p.value=w.register(c(h,i))}function c(i,l){console.log(document.querySelector("#"+i));const n=l||{shouldAnimate:!0,baseLayerPicker:!1,animation:!0,timeline:!0,infoBox:!1,selectionIndicator:!1,fullscreenButton:!1,geocoder:!1,homeButton:!1,navigationHelpButton:!1,sceneModePicker:!1,baseLayer:o.ImageryLayer.fromProviderAsync(o.TileMapServiceImageryProvider.fromUrl(o.buildModuleUrl("Assets/Textures/NaturalEarthII")),{show:!0})},t=new o.Viewer(i,n),v=t.cesiumWidget.creditContainer;v.style.display="none",t.scene.globe.enableLighting=!0,t.scene.skyBox.show=!1,t.scene.backgroundColor=o.Color.BLACK,t.scene.postProcessStages.fxaa.enabled=!0,t.imageryLayers.addImageryProvider(new o.TileCoordinatesImageryProvider),t.scene.debugShowFramesPerSecond=!0,t.scene.globe.depthTestAgainstTerrain=!1,t.clock.shouldAnimate=!0;const m=t.scene.screenSpaceCameraController;return m.zoomFactor=.95,t}return{d_viewer:p,isMounted:r,createViewer:u,destroyViewer:s}}const L=M({__name:"cesium-view",setup(h,{expose:e}){const{isMounted:r,createViewer:s,destroyViewer:u}=E("cesium-container"),c=g(),{toggle:i}=A(c);return b(()=>r.value,l=>{l?console.log("%c 挂载成功！！","padding: 2px 1px; border-radius: 3px 0 0 3px; color: #fff; background: green; font-weight: bold;"):console.log("%c 卸载成功！！","padding: 2px 1px; border-radius: 3px 0 0 3px; color: #fff; background: red; font-weight: bold;")},{flush:"sync"}),e({createViewer:s,destroyViewer:u}),(l,n)=>(V(),k("div",{ref_key:"fullEl",ref:c,class:"relative flex flex-col"},[d("div",{class:"da-btn da-btn-circle da-btn-info da-btn-sm absolute right-0 top-0 z-10 text-xs text-emerald-950",onClick:n[0]||(n[0]=(...t)=>f(i)&&f(i)(...t))},"全屏"),n[1]||(n[1]=d("div",{id:"cesium-container",class:"w-full flex-1"},null,-1)),d("div",null,[f(r)?C(l.$slots,"default",{key:0}):B("",!0)])],512))}});export{L as _,p as d,w as v};
